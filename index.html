<script type=module>const t=document.getElementsByTagName("canvas")[0],s=t.getContext("2d");function n(){t.width=window.innerWidth,t.height=window.innerHeight}function e(){s.fillStyle="#121212",s.fillRect(0,0,t.width,t.height)}class i extends class{constructor(t,n){this.t={x:t,y:n,dx:0,dy:0},this.i=!0}}{constructor(t,n){super(t,n),this.o=0}}class c extends i{constructor(t,n){super(t,n),this.h=10,this.u="#fff",this.orientation=0}}class o extends c{constructor(t,n){super(t,n),this.points=1}}class a extends c{constructor(t,n){super(t,n),this.h=10,this.u="#fff",this.M=1,this.l=0,this.o=5}}class r extends c{constructor(t,n,s){super(t,n),this.u=s,this.h=30}}class h extends o{constructor(t){super(1,1),this.h=3,this.p=t,this.v=(.1*Math.random()+.1)*(Math.random()<.5?-1:1),this.m=Math.random()*Math.PI*2,this.altitude=50*Math.random()+100,this.u="#afa",this.i=!1}}class f extends c{constructor(t,n){super(t,n),this.o=5,this.h=5,this.u="#d55",this.i=!1}}function u(t,n){const s=t.indexOf(n);s>-1&&t.splice(s,1)}function d(t,n){return s=t.x-n.x,e=t.y-n.y,Math.atan2(e,s);var s,e}function M(t,n=1){return{x:Math.cos(t)*n,y:Math.sin(t)*n}}function l(t,n){const s=t.h+n.h;return function(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}(t.t,n.t)<s}function p(t,n){const s=n.k;s.forEach(e=>{e===t||e instanceof a||(t instanceof a?e instanceof c&&l(t,e)&&function(t,n,s){const e=s.k;if(n instanceof o&&(s.points+=n.points,u(e,n)),n instanceof r){t.i=!0,t.orientation=d(t.t,n.t);const s=t.h+n.h,{x:e,y:i}=M(t.orientation,s);t.t.x=n.t.x+e,t.t.y=n.t.y+i,t.t.dx=0,t.t.dy=0}}(t,e,n):e instanceof c&&t instanceof c&&l(e,t)&&(console.log("Collision!"),u(s,t),e.i||u(s,e)))})}function w(n,e,i){s.strokeStyle="#eee",s.font=e+"em sans-serif";const o=t.width/2,a=s.measureText(n).width;s.strokeText(n,o-a/2,i)}let x=!1;const v=new class{constructor(){this.A=0,this.L="#ffe",this.P=3,this.F=200,this.j=[...Array(100)].map(t=>[Math.round(2e3*Math.random()),Math.round(2e3*Math.random())])}update(t){this.A+=t}q(){const t=this.P,n=this.F;let e=Math.round(this.A/n);this.j.forEach(([n,i])=>{switch(e=(e+1)%4,s.fillStyle=this.L,e){case 0:s.fillRect(n,i,t,t);break;case 1:case 3:s.fillRect(n-t,i,3*t,t),s.fillRect(n,i-t,t,3*t);break;case 2:s.fillRect(n-t,i,3*t,t),s.fillRect(n,i-t,t,3*t),s.fillStyle="#121212",s.fillRect(n,i,t,t)}})}},y={points:0,k:[new a(300,200),new r(300,300,"#f00"),new r(600,300,"#33f")]};let m=[];function k(t,n){const s=t.k;v.update(n);const e=s.find(t=>t instanceof a);if(x){if(e.i){const t=.2*e.M*n;let s=e.l+t;s>100?(e.M=-1,s-=s-100):s<0&&(e.M=1,s=Math.abs(s)),e.l=s}}else{const t=e.l;if(t){e.l=0,e.M=1,e.i=!1;const{x:n,y:s}=M(e.orientation,.002*t);e.t.dx=n,e.t.dy=s}}const o=s.filter(t=>t instanceof i);o.filter(t=>!t.i).forEach(s=>{var e;if(s instanceof h)return void function(t,n){t.m+=t.v*(n/1e3),t.t.x=t.altitude*Math.cos(t.m)+t.p.t.x,t.t.y=t.altitude*Math.sin(t.m)+t.p.t.y}(s,n);s.t=null!=(e=s.t)?e:{dx:0,dy:0};let i=0,a=0;o.forEach(t=>{if(s===t)return;const n=t.t.x-s.t.x||1e-8,e=t.t.y-s.t.y||1e-8,o=Math.sqrt(Math.pow(n,2)+Math.pow(e,2)),c=2e-5*s.o/(o*Math.sqrt(o+.15));i+=n*c,a+=e*c}),s.t.dx+=i*n,s.t.dy+=a*n,s instanceof c&&(s.orientation=Math.atan2(a,i)),s.t.x+=s.t.dx*n,s.t.y+=s.t.dy*n,p(s,t)})}y.k.forEach(t=>{if(t instanceof r){const n=Math.floor(10*Math.random()+10),s=new Array(n).fill(0).map(n=>new h(t));m=m.concat(s)}}),y.k=y.k.concat(m);let E=!1,b=0;function A(n){if(E)return e(),s.fillStyle="#222",s.fillRect(0,0,t.width,t.height),w("Planet Hoppers",6,150),void w("Press Space to Resume",3,300);e();const i=y.k;Math.floor(n/1e3)-Math.floor(b/1e3)&&i.push(new f(Math.random()*t.width,Math.random()*t.height));const o=n-b;var r;b=n,console.debug("FPS: "+1e3/o),k(y,o),v.q(),i.forEach(t=>{if(t instanceof c&&(s.beginPath(),s.fillStyle=function(t,n,e,i,o,a,c){const r=s.createLinearGradient(e,i,e+Math.cos(c)*o,i+Math.sin(c)*a);return r.addColorStop(0,t),r.addColorStop(1,"#000"),r}(t.u,0,t.t.x,t.t.y,2*t.h,2*t.h,t.orientation),s.arc(t.t.x,t.t.y,t.h,0,2*Math.PI),s.fill()),t instanceof a){const{t:n,l:e,h:i}=t;if(!e)return;s.fillStyle="#e43";const o=n.x+i+10,a=n.y-e;s.fillRect(o,a,10,e)}}),r=y,s.fillStyle="#eee",s.font="30px sans-serif",s.fillText("Points: "+r.points,10,40)}function L(){E=!0}function P(t){switch(t.key){case"Escape":return void L();case" ":return t.preventDefault(),E&&(E=!1),void(x=!0);default:console.debug("Unhandled keypress",t.key)}}function F(t){switch(t.key){case" ":t.preventDefault(),x=!1}}!function(){const t=n=>{A(n),requestAnimationFrame(t)};requestAnimationFrame(t),addEventListener("blur",L),addEventListener("keydown",P),addEventListener("keyup",F),addEventListener("resize",n),n()}()</script><style>*{margin:0;overflow:hidden}</style><canvas/>